<!DOCTYPE html>
<html>
    <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>FACE Website</title>
    <link href="http://code.google.com/apis/maps/documentation/javascript/examples/default.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false">
    </script>
    <script type="text/javascript" src="http://www.google.com/jsapi">
    </script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/dojo/1.6/dojo/dojo.xd.js" djConfig="parseOnLoad: true">
    </script>
    <link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/dojo/1.6/dijit/themes/claro/claro.css"/>
    <link rel="stylesheet" type="text/css" href="styles/styles.css">
    <script type="text/javascript">
        dojo.require("dojo.data.ItemFileReadStore");
        dojo.require("dijit.form.ComboBox");
        dojo.require("dojo.io.script");
        dojo.addOnLoad(onLoad);
        function onLoad(){
            var map = new google.maps.LatLng(50, 0);
            map = new google.maps.Map(document.getElementById('map_canvas'), {
                center: map,
                zoom: 4,
                mapTypeId: 'roadmap'
            });
            layer = new google.maps.FusionTablesLayer({
                query: {
                    select: 'geometry',
                    from: '1009188',
                    where: 'SpeciesID=16'
                }
            });
            layer.setMap(map);
            dojo.io.script.get({
                url: "http://www.google.com/fusiontables/api/query?sql=select%20ID,Scientific%20from%201009501&jsonCallback=done"
            });
        }
        
        function done(results){
            var rows = results.table.rows;
            var items = [];
            dojo.forEach(rows, function(row, i){
                items.push({
                    Scientific: row[1],
                    ID: row[0]
                });
            });
            speciesStore.data = {
                identifier: "ID",
                label: "Scientific",
                items: items
            };
        }
    </script>
</head>
<body class="claro">
    <div dojoType="dojo.data.ItemFileReadStore" jsId="speciesStore">
    </div>
    <div dojoType="dijit.form.ComboBox" store="speciesStore" searchAttr="Scientific">
    </div>
    <div id="map_canvas">
    </div>
</body>
</html>
